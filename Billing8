SELECT
			  PF.REFERENCE,
			  R.FULL_NAME,
			  BPM.DESCRIPTION,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',BPS.NAME_TYPE_XI18N,BPS.NAME_TYPE) AS STATUS,
			  BP.CREATION_DATE,
			  BP.END_DATE,
			  (
			    SELECT
			      MIN(CREATION_DATE)
			    FROM
			      GCCOM_BUDGET_PLAN
			    WHERE
			      COD_BUDGET_PLAN = BP.COD_BUDGET_PLAN
			  ) AS INIT_PLAN,
			  BP.QUOTA_AMOUNT,
			  ( (
			    SELECT
			      SUM(B.TOTAL_AMOUNT - B.PENDING_AMOUNT)
			    FROM
			      GCCOM_BILL B
			      INNER JOIN GCCOM_BUDGET_PLAN_BILLS BPB ON B.ID_BILL = BPB.ID_BILL
			    WHERE
			      BPB.ID_BUDGET_PLAN = BP.ID_BUDGET_PLAN
			  ) - (
			    SELECT
			      SUM(DA.AMOUNT)
			    FROM
			      GCCOM_BP_DISTRIBUTION_AMOUNT DA
			    WHERE
			      DA.ID_BUDGET_PLAN = BP.ID_BUDGET_PLAN
			      AND   DA.IND_CANCEL <> 1
			  ) ) AS REMAINING,
			  (
			    SELECT
			      SUM(B.PENDING_AMOUNT)
			    FROM
			      GCCOM_BILL B
			      INNER JOIN GCCOM_BUDGET_PLAN_BILLS BPB ON B.ID_BILL = BPB.ID_BILL
			    WHERE
			      BPB.ID_BUDGET_PLAN = BP.ID_BUDGET_PLAN
			  ) AS PENDING,
			  (
			    SELECT
			      COUNT(*)
			    FROM
			      GCCOM_BUDGET_PLAN_BILLS
			    WHERE
			      ID_BILL IS NOT NULL
			  ) AS QUOTAS_EMITTED,
			  BP.QUOTAS_TO_REVIEW,
			  BP.QUOTAS_TO_RENEWAL,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', TT.NAME_TYPE_XI18N, TT.NAME_TYPE) AS TRIGGER_TYPE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', CH.NAME_XI18N, CH.NAME) AS CHARGE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', RVT.NAME_TYPE_XI18N, RVT.NAME_TYPE) AS REVIEW_TYPE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', RWT.NAME_TYPE_XI18N, RWT.NAME_TYPE) AS RENEWAL_TYPE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', M_RE.NAME_TYPE_XI18N, M_RE.NAME_TYPE) AS REGULARIZATION_MODULE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}', M_QUO.NAME_TYPE_XI18N, M_QUO.NAME_TYPE) AS QUOTA_MODULE
FROM GCCOM_BUDGET_PLAN BP
  INNER JOIN GCCOM_PAYMENT_FORM PF ON BP.ID_PAYMENT_FORM=PF.ID_PAYMENT_FORM
  INNER JOIN GCCD_RELATIONSHIP R ON PF.ID_CUSTOMER=R.ID_RELATIONSHIP
  INNER JOIN GCCOM_BUDGET_PLAN_MASTER BPM ON BP.COD_BUDGET_PLAN_MASTER=BPM.COD_BUDGET_PLAN_MASTER
  INNER JOIN GCCOM_BP_STATUS BPS ON BP.STATUS=BPS.COD_DEVELOP
  INNER JOIN GCCOM_BP_TRIGGER_TYPE TT ON BPM.TRIGGER_TYPE=TT.COD_DEVELOP
  INNER JOIN GCCOM_CONCEPT_ASSOCCHARGETYPE CH ON BPM.ID_ONETIME_CHARGE=CH.ID_ONETIME_CHARGE
  INNER JOIN GCCOM_BP_REVIEW_TYPE RVT ON BPM.REVIEW_TYPE=RVT.COD_DEVELOP
  INNER JOIN GCCOM_BP_RENEWAL_TYPE RWT ON BPM.RENEWAL_TYPE=RWT.COD_DEVELOP
  INNER JOIN GCCOM_CALCULATION_MODULE M_RE ON BPM.ID_REGULARIZATION_CALC_MODULE=M_RE.ID_CALCULATION_MODULE
  INNER JOIN GCCOM_CALCULATION_MODULE M_QUO ON BPM.ID_QUOTA_CALC_MODULE=M_QUO.ID_CALCULATION_MODULE
			WHERE
			  ( '-999' = '$P!{Budget_Plan_Status}' OR BP.STATUS = '$P!{Budget_Plan_Status}' )	
