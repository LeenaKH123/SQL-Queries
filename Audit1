select PF.reference as Account,
N.NOTICE_NUMBER as Bill_ID,
N.SEND_DATE as Issue_Date,
BP.period_name as Billing_Period,
coalesce(D1.[TEXT], BT.NAME_TYPE ) AS 	  'Billing_Type',
PFT.DESCRIPTION as DESCRIPTION,
( CASE
when B.ID_OFFERED_SERVICE = 1 then 'Electricity'
when B.ID_OFFERED_SERVICE = 19 then 'Water'
when B.ID_OFFERED_SERVICE = 176 then 'Rate'
ELSE 'Others'
End ) as TYPE,
B.TOTAL_AMOUNT as 'TOTAL_AMOUNT',
BU.USAGE as USAGE
from GCCB_NOTICE N
join GCCB_NOTICE_BILL NB on NB.ID_NOTICE = N.ID_NOTICE
join GCCOM_PAYMENT_FORM PF on PF.ID_PAYMENT_FORM = N.ID_PAYMENT_FORM
join GCCOM_PAYMENT_FORM_TYPE PFT on PFT.COD_DEVELOP = PF.COD_TYPE
join GCCOM_BILL B on B.ID_BILL = NB.ID_BILL
join GCCOM_BILLING_TYPE BT on BT.COD_DEVELOP = B.BILLING_TYPE
join GCTS_DICTIONARY D1 on BT.NAME_TYPE_XI18N = D1.ID and D1.LOCALE = 'en' 
join GCCOM_BILLING_PERIOD BP on BP.ID_BILLING_PERIOD = B.ID_BILLING_PERIOD
join GCCOM_BILLED_USAGE BU on BU.ID_BILL = B.ID_BILL
WHERE ($X{IN, PFT.DESCRIPTION, AuditDescription})
