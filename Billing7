SELECT
			  PF.REFERENCE,
			  R.FULL_NAME,
			  BPM.DESCRIPTION,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',BPS.NAME_TYPE_XI18N,BPS.NAME_TYPE) AS STATUS,
			  BP.CREATION_DATE,
			  BP.END_DATE,
			  (
			    SELECT
			      MIN(CREATION_DATE)
			    FROM
			      GCCOM_BUDGET_PLAN
			    WHERE
			      COD_BUDGET_PLAN = BP.COD_BUDGET_PLAN
			  ) AS INIT_PLAN,
			  BP.QUOTA_AMOUNT,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',QUO_S.NAME_TYPE_XI18N,QUO_S.NAME_TYPE) AS STATUS_QUOTA,
			  BPQ.EMISSION_DATE,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',PERIOD.PERIOD_NAME_XI18N,PERIOD.PERIOD_NAME) AS BILLING_PERIOD,
			  BPQ.AMOUNT,
			  BPQ.IND_REGULARIZATION,
			  BILL.BILL_NUMBER,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',BILL_STATUS.NAME_TYPE_XI18N,BILL_STATUS.NAME_TYPE) AS BILLING_STATUS,
			  OUC_REPORT.I18N_JASPER('$P!{Language}',COLL_STATUS.NAME_TYPE_XI18N,COLL_STATUS.NAME_TYPE) AS COLLECTION_STATUS,
			  BILL.PENDING_AMOUNT
			FROM
			  GCCOM_BUDGET_PLAN BP
			  INNER JOIN GCCOM_PAYMENT_FORM PF ON BP.ID_PAYMENT_FORM = PF.ID_PAYMENT_FORM
			  INNER JOIN GCCD_RELATIONSHIP R ON PF.ID_CUSTOMER = R.ID_RELATIONSHIP
			  INNER JOIN GCCOM_BUDGET_PLAN_MASTER BPM ON BP.COD_BUDGET_PLAN_MASTER = BPM.COD_BUDGET_PLAN_MASTER
			  INNER JOIN GCCOM_BP_STATUS BPS ON BP.STATUS = BPS.COD_DEVELOP
			  INNER JOIN GCCOM_BUDGET_PLAN_QUOTA BPQ ON BP.ID_BUDGET_PLAN = BPQ.ID_BUDGET_PLAN
			  INNER JOIN GCCOM_BP_QUOTA_STATUS QUO_S ON BPQ.STATUS = QUO_S.COD_DEVELOP
			  LEFT JOIN GCCOM_BILLING_PERIOD PERIOD ON BPQ.ID_BILLING_PERIOD = PERIOD.ID_BILLING_PERIOD
			  LEFT JOIN GCCOM_BILL BILL ON BPQ.ID_BILL = BILL.ID_BILL
			  LEFT JOIN GCCOM_BILL_STATUS BILL_STATUS ON BILL.BILLING_STATUS = BILL_STATUS.COD_DEVELOP
			  LEFT JOIN GCCOM_BILL_STATUS COLL_STATUS ON BILL.COLLECTION_STATUS = COLL_STATUS.COD_DEVELOP
			WHERE
			  ( '-999' = '$P!{Budget_Plan_Status}' OR BP.STATUS = '$P!{Budget_Plan_Status}' )
			  AND BPQ.STATUS <> 'BPSTAQU005'
			  
			 order by   BP.CREATION_DATE,PF.REFERENCE
