	SELECT
	DISTINCT DATENAME(MONTH,
	BILL.BILLING_DATE) AS 'BILLING DATE MONTH',
	REL.FULL_NAME AS 'CUSTOMER NAME',
	F.REFERENCE AS 'ACCOUNT NUMBER',
	GA.ADDRESS AS 'ADDRESS',
	PS.NAME_TYPE AS 'ACCOUNT STATUS',
	ISNULL((
	SELECT
		BU.[USAGE]
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 19
		AND BILL_ELE.ID_BILL = BILL.ID_BILL),
	0) AS 'WATER CONSUMPTION (M3)',
	ISNULL((
	SELECT
		BILL.PENDING_AMOUNT
	FROM
		GCCOM_BILL BILL_WAT
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 19
		AND BILL_WAT.ID_BILL = BILL.ID_BILL),
	0) AS 'WATER CONSUMPTION (BD)',
	ISNULL((
	SELECT
		BU.[USAGE]
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BILL_ELE.ID_BILL = BILL.ID_BILL
		AND BU.USAGE_TYPE = 'TPCONS0001'),
	0) AS 'ELECTRICITY ACTIVE CONSUMPTION (KWH)',
	ISNULL((
	SELECT
		BILL.PENDING_AMOUNT
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BILL_ELE.ID_BILL = BILL.ID_BILL
		AND BU.USAGE_TYPE = 'TPCONS0001'),
	0) AS 'ELECTRICITY ACTIVE CONSUMPTION (BD)',
	ISNULL((
	SELECT
		BU.[USAGE]
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BILL_ELE.ID_BILL = BILL.ID_BILL
		AND BU.USAGE_TYPE = 'TPCONS0002'),
	0) AS 'EXCESS OF REACTIVE CONSUMPTION (KVARH)',
	ISNULL((
	SELECT
		BILL.PENDING_AMOUNT
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BILL_ELE.ID_BILL = BILL.ID_BILL
		AND BU.USAGE_TYPE = 'TPCONS0002'),
	0) AS 'EXCESS OF REACTIVE CONSUMPTION (BD)',
	NULL AS 'POWER FACTOR SUPPLY',
	NULL AS 'POWER FACTOR (MP1)',
	NULL AS 'POWER FACTOR (MP2)',
	NULL AS 'POWER FACTOR (MP3)',
	BILL.TOTAL_AMOUNT AS 'TOTAL (BD)',
	(
	SELECT
		MAX(BU.[USAGE])
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL_ELE.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL_ELE.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BU.USAGE_TYPE = 'TPCONS0002') AS 'MAX DEMAND- KVA',
	(
	SELECT
		AVG(BU.[USAGE])
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL_ELE.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL_ELE.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BU.USAGE_TYPE = 'TPCONS0002') AS 'AVERAGE',
	(
	SELECT
		MIN(BU.[USAGE])
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL_ELE.ID_PAYMENT_FORM
	LEFT JOIN GCCOM_BILLED_USAGE BU ON
		BILL_ELE.ID_BILL = BU.ID_BILL
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		AND BU.USAGE_TYPE = 'TPCONS0002') AS 'MIN'
FROM
	GCCOM_BILL BILL
INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENT_FORM F ON
	F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
INNER JOIN OUC_COMMON_ADMIN.GCCD_RELATIONSHIP REL ON
	F.ID_CUSTOMER = REL.ID_RELATIONSHIP
INNER JOIN OUC_COMMON_ADMIN.GCCOM_ADDRESS GA ON
	GA.ID_ADDRESS = REL.ID_ADDRESS
INNER JOIN OUC_COMMON_ADMIN.GCCOM_PAYMENTFORM_STATUS PS ON
	PS.COD_DEVELOP = F.PF_STATUS
LEFT JOIN GCCOM_BILLED_USAGE BU ON
	BILL.ID_BILL = BU.ID_BILL
WHERE
	F.REFERENCE = '$P!{Enter_Account_Number}'
	AND BILL.BILLING_DATE > '$P!{Date_From}'
	AND BILL.BILLING_DATE < '$P!{Date_To}'
