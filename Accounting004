SELECT	ge_gov.ENTITY_NAME 			as Governorate,
		ge_block.ENTITY_NAME 		as Block,
		office.COD_OFFICE +' - '+ office.OFFICE_NAME as CommercialOffice,
		emp.NAME 					as AGENT,
		rel.FULL_NAME 				as Customer,
		rel.DOC_NUMBER 				as CustomerCPR,
		pm.REFERENCE 				as Account,
		com.COD_REF_COMPLAINT 		as RCCSnumber,
		cc.NAME_TYPE				as RCCSgroup,
		ct.NAME_TYPE 				as RCCStype,
		cs.NAME_TYPE 				as RCCSstatus,
		resp.EXPIRATION_DATE 		as DueDate,
		ge_block.ENTITY_NAME +', '+ ge_gov.ENTITY_NAME +', '+ ge_c.ENTITY_NAME as Address,
		resp.CHANGE_STEP_DATE 		as LastChangeDate
FROM GCCC_COMPLAINT com 
	INNER JOIN  GCCOM_GEOGRAPHIC_ENTITY GE_BLOCK
		INNER JOIN GCCOM_GEOGRAPHIC_ENTITY ge_gov ON GE_BLOCK.ID_GEO_ENTITY_P = ge_gov.ID_GEO_ENTITY
		INNER JOIN GCCOM_GEOGRAPHIC_ENTITY ge_c ON ge_gov.ID_GEO_ENTITY_P = ge_c.ID_GEO_ENTITY
	ON ge_block.ID_GEO_ENTITY = com.ID_GEO_ENTITY
	INNER JOIN GCGT_WF_ENTITY_RESPONSIBLE resp 
		INNER JOIN GCCB_OFFICE office ON office.ID_OFFICE = resp.ID_OFFICE
		INNER JOIN GCCB_EMPLOYEE emp ON emp.ID_EMPLOYEE_CB = resp.ID_EMPLOYEE
	ON resp.ID_ENTITY_RESPONSIBLE = com.ID_RESPONSIBLE
	INNER JOIN GCCD_RELATIONSHIP rel ON rel.ID_RELATIONSHIP = com.ID_RELATIONSHIP
	INNER JOIN GCCOM_PAYMENT_FORM pm ON pm.ID_PAYMENT_FORM = com.ID_ACCOUNT 
	INNER JOIN GCCC_CLASS_COMPLAINT_ASOC cca 
		INNER JOIN GCCC_COMPLAINT_CLASS cc  ON cca.COD_CLASS = cc.COD_DEVELOP
	ON cca.ID_COMPLAINT_TYPE = com.ID_COMPLAINT_TYPE
	INNER JOIN GCCC_COMPLAINT_TYPE ct ON ct.ID_COMPLAINT_TYPE = com.ID_COMPLAINT_TYPE
	INNER JOIN GCCC_COMPLAINT_STATUS cs ON cs.COD_DEVELOP = com.COD_STATUS_COMPLAINT
