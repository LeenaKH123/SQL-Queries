		SELECT
	REL.FULL_NAME AS 'CUSTOMER NAME',
	F.REFERENCE AS 'ACCOUNT NUMBER',
	FT.DESCRIPTION AS 'SIGNAL',
	CFT.NAME_TYPE AS 'ACCOUNT TYPE',
	NULL AS 'BULK ACCOUNT',
	DATENAME(MONTH,
	BILL.BILLING_DATE) AS 'BILLING DATE MONTH',
	(
	SELECT
		COUNT(BILL.ID_BILL)
	FROM
		GCCOM_BILL BILL
	INNER JOIN GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND CAST(BILL.BILLING_DATE AS DATE) > '$P!{Date_From}'
		AND CAST(BILL.BILLING_DATE AS DATE) < '$P!{Date_To}') AS 'BILL NO IN BILL DATE',
	ISNULL((
	SELECT
		BILL_WAT.PENDING_AMOUNT
	FROM
		GCCOM_BILL BILL_WAT
	INNER JOIN GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 19
		and bill.ID_BILL = bill_wat.ID_BILL),
	0) AS 'WATER AMOUNT',
	ISNULL((
	SELECT
		BILL_ELE.PENDING_AMOUNT
	FROM
		GCCOM_BILL BILL_ELE
	INNER JOIN GCCOM_PAYMENT_FORM F ON
		F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
	WHERE
		F.REFERENCE = '$P!{Enter_Account_Number}'
		AND BILL.ID_OFFERED_SERVICE = 1
		and bill.ID_BILL = bill_ele.ID_BILL),
	0) AS 'ELECTRICITY',
	BILL.EXCHANGE_RATE AS 'RATE',
	BILL.TOTAL_AMOUNT AS 'TOTAL',
	BILL.NOTTAXBILL_AMOUNT AS 'PAYMENTS',
	NULL AS 'OTHER TRANSACTION',
	BS.NAME_TYPE AS 'BILL STATE',
	NULL AS 'RENT'
FROM
	GCCOM_BILL BILL
INNER JOIN GCCOM_PAYMENT_FORM F ON
	F.ID_PAYMENT_FORM = BILL.ID_PAYMENT_FORM
INNER JOIN GCCD_RELATIONSHIP REL ON
	F.ID_CUSTOMER = REL.ID_RELATIONSHIP
INNER JOIN GCCOM_PAYMENT_FORM_TYPE FT ON
	FT.COD_DEVELOP = F.COD_TYPE
INNER JOIN GCCOM_COLLECTION_FORM_TYPE CFT ON
	CFT.COD_DEVELOP = F.COLLECTION_FORM_TYPE
INNER JOIN GCCOM_BILL_STATUS BS ON
	BS.COD_DEVELOP = BILL.BILLING_STATUS
WHERE
	F.REFERENCE = '$P!{Enter_Account_Number}'
	AND (CAST(BILL.BILLING_DATE AS DATE) > '$P!{Date_From}'
	AND CAST(BILL.BILLING_DATE AS DATE) < '$P!{Date_To}')
